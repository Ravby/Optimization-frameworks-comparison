function f = ypea_test_function(func)
    % Ruturns function handle to predefined benchmark functions
    if ~exist('func', 'var') || isempty(func)
        error('Function name needed.');
    end
    
    f = str2func(func);

end


function z = ShiftedSphere(x) %#ok
    shift = [45.00458616074768, -50.34195790924958, 16.656571994777153, -70.66157384610746, 77.87240204480926, ...
                            41.15636478376551, 49.128266155105166, -60.307473748449034, 33.10423742373693, 0.6236286355758835, ...
                            27.460586290936902, -36.02013445020688, -40.00877054048374, -64.66271141874185, 68.90566619452034, ...
                            62.70237277088032, -4.074486986783384, -1.317873518733137, -55.54285608300457, -47.34319489184719, ...
                            12.507912147062243, -40.535720288582304, 33.31036155896686, -28.838912135698926, -1.4693369446360407, ...
                            -10.418532078512769, 73.36998380030019, -21.21493655887511, 44.00620956459555, 53.63261051536182, ...
                            2.7285937751837395, 13.470863898732262, 18.406813289986204, 79.81576486014623, 11.44319844208276, ...
                            54.93447134455431, 57.30432717171027, 40.23921236138773, 65.67885067903487, 26.366481706628406, ...
                            -27.30759152512293, 25.811669049736366, 33.765769465674026, 46.064188205488364, 68.68320146596031, ...
                            -30.14247692338735, -20.27099815222924, 72.28995446564878, -23.225596585148693, -17.707777462132427, ...
                            -16.533526290183076, 52.71601762751186, -34.19215602995044, 17.794220792755056, 62.28063781336567, ...
                            48.17997449949212, -62.87666397080855, -0.3946724203053975, -63.61229513391514, 62.025414757794124];
    
    z = sum((x-shift).^2);
end

function z = Sphere(x) %#ok
    z = sum(x.^2);
end

function z = ShiftedSumOfSquares(x)
    shift = [22.479705250884777, 60.75750080751871, -59.15674324461888, 27.56336400934657, -59.29279403989607, ...
                        -64.68447838216555, 78.33759532500437, -76.51052473538245, -66.6507114149451, 64.93462028133038, ...
                        -15.23828302367869, -17.825823787619903, -31.92405019180454, 67.72646439056987, -0.9830868197666973, ... 
                        39.91084384292476, 1.4187967568760484, 24.815734535933146, -3.3313494842577285, 18.8446220852682, ...
                        -17.002497910454828, 50.326561978450655, 53.95001535109091, 18.403170606945253, -21.184841218701195, ...
                        -62.069991345971154, -43.868924783714164, -24.682337470629072, -2.8605529514137373, 65.39162073164252, ...
                        2.6654994832190937, 23.60580815931415, 13.846698992449433, -41.45381813820245, -76.7118669691122, ...
                        40.566665904615746, 22.28454884887448, -55.31708080994516, -76.649068909635, 40.966439161432476, ...
                        -3.0455255815577402, 3.119008384655956, 18.342768255788243, -20.144695942649946, 8.54936385804288, ...
                        50.45305033701291, 23.2263485421784, 10.68869991058412, 74.77290130427247, 33.82014641772588, ...
                        -19.74543928622861, -43.37360584484172, 79.02166733921979, -45.92410252364756, -44.01344981695157, ...
                        44.109743914203506, -77.20689956137252, -72.65296438262618, 46.613878010132, -14.343495951611033];
    n = size(x, 2);
    weights = 1:n;
    z = sum(weights .* ((x - shift) .^ 2));
end

function z = SumOfSquares(x)
    n = size(x, 2);
    weights = 1:n;
    z = sum(weights .* (x.^ 2));
end

function z = ShiftedSchwefel(x)
    shift = [65.90306349157711, 7.223609380925922, 48.06403595428989, -61.23008904674027, -56.996531732952235, ...
                        -65.67006959079087, 56.81852866354663, -49.51353093024842, -42.403457350576694, 64.22460834371887, ...
                        -15.782490031817943, 78.2275393766464, 58.981759831549084, -41.74229801452056, 70.70390026719807, ...
                        -27.120714671264494, -43.362534341811525, -11.357893018802812, 25.329639322623194, -24.02213869456814, ...
                        -29.51839742945309, -50.65352492132828, -17.33907934005014, -75.7276769694174, 25.60834507308691, ...
                        -40.61133175959546, 53.35222265494423, 30.414516938139826, -37.83651132063628, 30.243572616044418, ...
                        -2.2080543227080227, -51.34193306616531, 37.36039082956739, -44.93167877354562, 63.19570228206453, ...
                        -0.3230550173947364, 54.997116479336086, -39.773290218583256, 54.1565458883382, 12.124637138785076, ...
                        43.85247188324382, -75.91826727683562, 49.74255951193999, 63.92380934836413, 54.34684698334098, ...
                        -19.563396930885908, 31.656857648987852, -32.907795698796306, -29.963471074339374, -60.672896416251675, ...
                        -77.62660870400686, -75.95478227792732, 23.6157226667015, 75.57747129002121, -15.915369172179027, ...
                        -45.240636434786694, 34.3519391836095, 65.07767014581174, 13.32242757194949, 71.34237817983137];

   z = sum(cumsum((x - shift),2).^2);
end

function z = Schwefel(x)
   z = sum(cumsum(x,2).^2);
end


function z = ShiftedRastrigin(x) %#ok
    shift = [4.070088073870897, -3.3584914395112166, 2.5276924556298725, 1.373781594176445, -1.8387129521132595, ...
                        2.057549949794417, -0.0023364913111585395, 2.013487904123477, -3.7248964059839147, -0.33919629789907413, ... 
                        2.8301821463273367, -2.2929959706368352, -2.2706325455604484, -3.513692538288365, -1.523336663056385, ... 
                        -4.0764777207287075, -1.6237586256460155, 0.9178097684770039, -0.2723487256238868, -2.9841270159498463, ... 
                        2.9288432571682828, 0.22934413055341984, 3.720378352924264, -1.429905611686805, 1.6068438224463835, ...
                        2.1513735804078467, -0.6971225700819095, -2.8180867567781878, -1.2171333029086893, -4.064563849878518, ...
                        1.3543350787859474, 2.4050645503835417, -2.5584324886855985, 1.5660383241939355, 2.1289004812453385, ...
                        3.8337296275949706, -0.5606593824135673, 1.141577243686811, 0.8120054159429309, 0.5394159295625087, ...
                        -2.5598649074502093, 4.033201745873486, 3.24227861085845, 2.916933432390337, 3.639752419533484, ...
                        1.5188619717725969, 3.839178330380485, 3.975865667365813, -1.191858979126291, -3.489747339689812, ...
                        3.6319133591436685, -0.8694397826397151, -0.039238131176527524, 0.857258173067124, 3.5742721242496724, ...
                        -1.2964486629139182, 0.622681353542129, -3.2417846861744932, -3.5847655715322952, -0.20674408185538518];

    z = sum((x - shift).^2-10*cos(2*pi*(x - shift))+10,2);
end


function z = Rastrigin(x) %#ok
    z = sum(x.^2-10*cos(2*pi*x)+10);
end

function z = ShiftedAckley(x) %#ok
    shift = [21.125524221556333, -11.11861062406522, -8.384759722218377, -4.998410532366073, 15.080716791129063, ...
                        17.219200462474568, 17.30816180946608, 10.917710600242835, 20.963400683396372, 19.33124762324178, ...
                        -10.07785283476705, -0.6470251048379687, -9.17403575481461, 0.2263125149343992, 3.5360559029458436, ...
                        -24.976221736741277, 5.4509130845083185, -22.008998257857435, 4.319939429353628, -0.015227633728962076, ...
                        -10.266583117363774, -2.984262944040246, -14.575704508621596, 9.332038871399178, 12.260212736282845, ...
                        2.6286817951067007, 3.7062873124753715, -7.422751349625646, 22.839645124520274, 18.139957746273467, ...
                        -23.12538796733297, 3.106978031277709, -21.8650793129579, 23.285704349592457, -8.877654886311145, ...
                        -15.936478675865914, -14.529257223964459, -0.5256354355698463, 3.421693809849465, -22.925462999946205, ...
                        -13.789171558857868, -12.260934479396866, 0.8518120279262078, -6.2876202233673375, 17.750101847964885, ...
                        24.91013310009094, -3.1246259173628452, -7.631501678844927, -7.124798758640981, 0.9420940535559126, ...
                        -3.5298708787570163, -13.655076475547936, -3.220475098055129, -0.7478333903264627, 13.62921655558997, ...
                        -3.336289145576181, -1.7729883120516092, -2.487660518823951, 13.831869546225832, 3.8314346375240227];

    z = -20*exp(-0.2*sqrt(mean((x - shift).^2,2))) - exp(mean(cos(2*pi*(x - shift)),2)) + 20 + exp(1);
end

function z = Ackley(x) %#ok
    z = -20*exp(-0.2*sqrt(mean(x.^2,2))) - exp(mean(cos(2*pi*x),2)) + 20 + exp(1);
end

function z = ShiftedGriewank(x)
    shift = [104.94691081342978, -135.6761348470227, 92.81100891955543, -10.87108518188711, 407.63013054172563, ...
                        -223.31315231746964, -224.56627659185563, -222.7632371161696, -338.7309010063917, -236.65660889064418, ...
                        -102.44810336184622, 126.42998956660733, 145.51932139597716, 362.4195007946686, -136.07822974158148, ...
                        385.3787391034516, 224.54916653990915, 43.478124239142176, 174.10299590196337, -214.8310656032395, ...
                        -398.01422639093084, -309.2614310193993, -178.06570153291875, -162.6651823263993, 450.850657541738, ...
                        -454.92932203096916, -419.61768171271166, -297.80826342133184, 66.9431726795051, 81.54612611060406, ...
                        33.75350391540678, 452.7503721088576, -394.37679317004665, 211.96497077719948, 209.2762825707889, ...
                        -456.2796841185877, 43.786866583660526, 39.94139518856173, -392.0757065399322, 368.3834199650955, ...
                        -230.1695108177757, 260.9386598025741, 424.9982235544909, 219.5539088594145, -56.74195565523951, ...
                        353.31823225966764, -314.409074063865, -344.22129416136335, 350.389300480917, 210.6305580593255, ...
                        -351.3688705488921, -419.56080494622336, -352.4149162964608, -306.0148711883166, 234.1092941008617, ...
                        179.7062426106279, -180.45299833941465, -353.7895714765393, 304.63535113945875, 11.040575864524044];

    z = 1/4000*sum((x - shift).^2,2) - prod(cos((x - shift)./sqrt(repmat(1:size((x - shift),2),size((x - shift),1),1))),2) + 1;
end

function z = Griewank(x)
    z = 1/4000*sum(x.^2,2) - prod(cos(x./sqrt(repmat(1:size(x,2),size(x,1),1))),2) + 1;
end

function z = Rosenbrock(x) %#ok
    z = sum(100*(x(:,2:end)-x(:,1:end-1).^2).^2+(x(:,1:end-1)-1).^2);
end

function z = ShekelsFoxholes(x)
    a = repmat(-32:16:32,5,1);
    a = [reshape(a',1,[]);reshape(a,1,[])];
    z = zeros(size(x,1),1);
        for i = 1 : size(x,1)
            z(i) = 1./(1/500+sum(1./((1:25)+sum((repmat(x(i,:)',1,25)-a).^6,1))));
        end
end

function z = SixHumpCamelBack(x)
    z = 4*x(:,1).^2-2.1*x(:,1).^4+x(:,1).^6/3+x(:,1).*x(:,2)-4*x(:,2).^2+4*x(:,2).^4;
end

function z = Branin(x)
    z = (x(:,2)-5.1/4/pi.^2*x(:,1).^2+5/pi*x(:,1)-6).^2 + 10*(1-1/8/pi)*cos(x(:,1)) + 10;
end

function z = GoldsteinPrice(x)
    z = (1+(x(:,1)+x(:,2)+1).^2.*(19-14*x(:,1)+3*x(:,1).^2-14*x(:,2)+6*x(:,1).*x(:,2)+3*x(:,2).^2)).*...
                     (30+(2*x(:,1)-3*x(:,2)).^2.*(18-32*x(:,1)+12*x(:,1).^2+48*x(:,2)-36*x(:,1).*x(:,2)+27*x(:,2).^2)); 
end

function z = Hartman(x)
    a = [3 10 30;0.1 10 35;3 10 30;0.1 10 35];
    c = [1;1.2;3;3.2];
    p = [0.3689 0.1170 0.2673;0.4699 0.4387 0.7470;0.1091 0.8732 0.5547;0.03815 0.5743 0.8828];
    z = zeros(size(x,1),1);
    for i = 1 : size(x,1)
        z(i) = -sum(c.*exp(-sum(a.*(repmat(x(i,:),4,1)-p).^2,2)));
    end
end
